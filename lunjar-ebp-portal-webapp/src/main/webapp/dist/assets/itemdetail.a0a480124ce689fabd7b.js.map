{"version":3,"sources":["webpack:///itemdetail.a0a480124ce689fabd7b.js","webpack:///./assets/pages/itemdetail/index.js"],"names":["webpackJsonp","0","module","exports","__webpack_require__","38","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_jquery","_jquery2","_component","_itemApi","ItemDetail","this","productId","globalData","carBox","init","value","_this","initSwiper","initExpress","initEvent","getCartNum","getItemDetail","then","res","_ref","data","product","productSkus","Swiper","pagination","loop","autoplay","console","log","ecPrice","price","split","html","_this2","document","on","e","$this","currentTarget","type","initShopCart","show","AddToCar","id","window","location","$num","num","getListCart","carts","forEach","cart","text","69"],"mappings":"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","file":"itemdetail.a0a480124ce689fabd7b.js","sourcesContent":["webpackJsonp([8],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(38);\n\n\n/***/ },\n\n/***/ 38:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _jquery = __webpack_require__(1);\n\t\n\tvar _jquery2 = _interopRequireDefault(_jquery);\n\t\n\tvar _component = __webpack_require__(3);\n\t\n\tvar _itemApi = __webpack_require__(5);\n\t\n\t__webpack_require__(69);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar ItemDetail = function () {\n\t  function ItemDetail() {\n\t    _classCallCheck(this, ItemDetail);\n\t\n\t    this.productId = globalData.productId;\n\t    this.carBox;\n\t    this.init();\n\t  }\n\t\n\t  _createClass(ItemDetail, [{\n\t    key: 'init',\n\t    value: function init() {\n\t      var _this = this;\n\t\n\t      // 轮播\n\t      this.initSwiper();\n\t      // 运费\n\t      this.initExpress();\n\t      // 事件\n\t      this.initEvent();\n\t      // 获取购物车数量\n\t      this.getCartNum();\n\t      (0, _itemApi.getItemDetail)(this.productId).then(function (res) {\n\t        var _ref = [res.data.product, res.data.productSkus];\n\t        _this.product = _ref[0];\n\t        _this.productSkus = _ref[1];\n\t      });\n\t    }\n\t  }, {\n\t    key: 'initSwiper',\n\t    value: function initSwiper() {\n\t      new _component.Swiper('.js-top-swiper', {\n\t        pagination: '.swiper-pagination',\n\t        loop: true,\n\t        autoplay: 3000\n\t      });\n\t    }\n\t  }, {\n\t    key: 'initExpress',\n\t    value: function initExpress() {\n\t      // var prices = []\n\t      // globalData.ecPrice.split(';').forEach(item => {\n\t      //   var p = item.split(':')[1].split(',');\n\t      //   prices.push(+p[0], +p[0] + (+p[1] || 0));\n\t      // });\n\t      // var maxPrice = Math.max.apply(null, prices);\n\t      // var minPrice = Math.min.apply(null, prices);\n\t      console.log(globalData);\n\t      if (globalData.ecPrice) {\n\t        var price = globalData.ecPrice.split(';')[0].split(':')[1].split(',')[0];\n\t\n\t        (0, _jquery2.default)('.js-express-price').html('￥' + price);\n\t      }\n\t      // $('.js-express-price').html(maxPrice === minPrice ? `￥${maxPrice}` : `￥${minPrice} ~ ￥${maxPrice}`);\n\t    }\n\t  }, {\n\t    key: 'initEvent',\n\t    value: function initEvent() {\n\t      var _this2 = this;\n\t\n\t      (0, _jquery2.default)(document).on('click', '.js-addcart', function (e) {\n\t        var $this = (0, _jquery2.default)(e.currentTarget);\n\t        var type = $this.data('type');\n\t        if (!_this2.carBox) {\n\t          _this2.initShopCart();\n\t        }\n\t        _this2.carBox.show(_component.AddToCar[type], _this2.product, _this2.productSkus);\n\t      }).on('click', '.js-to-combine', function (e) {\n\t        var $this = (0, _jquery2.default)(e.currentTarget);\n\t        var id = $this.data('id');\n\t        window.location = '/product/combinationProdDetail?id=' + id;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'initShopCart',\n\t    value: function initShopCart() {\n\t      this.carBox = new _component.AddToCar();\n\t\n\t      this.carBox.on('add', function (data) {\n\t        var $num = (0, _jquery2.default)('.js-cart-num');\n\t        var num = +$num.html();\n\t        num += data.num;\n\t        $num.html(num);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'getCartNum',\n\t    value: function getCartNum() {\n\t      (0, _itemApi.getListCart)().then(function (res) {\n\t        var $num = (0, _jquery2.default)('.js-cart-num');\n\t        var num = 0;\n\t\n\t        if (res.data.carts) {\n\t          res.data.carts.forEach(function (cart) {\n\t            num += cart.num;\n\t          });\n\t        }\n\t        $num.text(num);\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return ItemDetail;\n\t}();\n\t\n\t(0, _jquery2.default)(function () {\n\t  new ItemDetail();\n\t});\n\n/***/ },\n\n/***/ 69:\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** itemdetail.a0a480124ce689fabd7b.js\n **/","import $ from 'jquery';\nimport {\n  Swiper,\n  AddToCar\n} from 'component';\nimport { getItemDetail, getListCart } from '../../api/item-api';\nimport './style';\n\nclass ItemDetail {\n  constructor() {\n    this.productId = globalData.productId;\n    this.carBox;\n    this.init();\n  }\n\n  init() {\n    // 轮播\n    this.initSwiper();\n    // 运费\n    this.initExpress();\n    // 事件\n    this.initEvent();\n    // 获取购物车数量\n    this.getCartNum();\n    getItemDetail(this.productId).then(res => {\n      [this.product, this.productSkus] = [res.data.product, res.data.productSkus];\n    });\n  }\n\n  initSwiper() {\n    new Swiper('.js-top-swiper', {\n      pagination: '.swiper-pagination',\n      loop: true,\n      autoplay: 3000\n    });\n  }\n\n  initExpress() {\n    // var prices = []\n    // globalData.ecPrice.split(';').forEach(item => {\n    //   var p = item.split(':')[1].split(',');\n    //   prices.push(+p[0], +p[0] + (+p[1] || 0));\n    // });\n    // var maxPrice = Math.max.apply(null, prices);\n    // var minPrice = Math.min.apply(null, prices);\n    console.log(globalData);\n    if (globalData.ecPrice) {\n      const price = globalData.ecPrice.split(';')[0].split(':')[1].split(',')[0];\n\n      $('.js-express-price').html(`￥${price}`);\n    }\n    // $('.js-express-price').html(maxPrice === minPrice ? `￥${maxPrice}` : `￥${minPrice} ~ ￥${maxPrice}`);\n  }\n\n  initEvent() {\n    $(document).on('click', '.js-addcart', (e) => {\n      var $this = $(e.currentTarget);\n      var type = $this.data('type');\n      if (!this.carBox) {\n        this.initShopCart();\n      }\n      this.carBox.show(AddToCar[type], this.product, this.productSkus);\n    }).on('click', '.js-to-combine', (e) => {\n      var $this = $(e.currentTarget);\n      var id = $this.data('id');\n      window.location = `/product/combinationProdDetail?id=${id}`;\n    });\n  }\n\n  initShopCart() {\n    this.carBox = new AddToCar();\n\n    this.carBox.on('add', (data) => {\n      var $num = $('.js-cart-num');\n      var num = +$num.html();\n      num += data.num;\n      $num.html(num);\n    });\n  }\n\n  getCartNum() {\n    getListCart().then(res => {\n      const $num = $('.js-cart-num');\n      let num = 0;\n\n      if (res.data.carts) {\n        res.data.carts.forEach(cart => {\n          num += cart.num;\n        });\n      }\n      $num.text(num);\n    });\n  }\n}\n\n$(() => {\n  new ItemDetail();\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./assets/pages/itemdetail/index.js\n **/"],"sourceRoot":""}