webpackJsonp([2],{0:function(t,i,e){t.exports=e(35)},35:function(t,i,e){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var c=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),o=e(3);e(66);var s=e(1),u=n(s),r=e(2),d=n(r),l=e(84),m=n(l),f=e(83),p=n(f),h=e(5),v=function(){function t(){a(this,t),this.combinationProducts=globalData.combinationProducts,this.combinationProduct,this.init()}return c(t,[{key:"init",value:function(){this.combinationProduct=this.getCp(0),this.renderTab(),this.renderItemList(),this.initEvent()}},{key:"setTotalPrice",value:function(){var t=0,i=0;this.combinationProduct.forEach(function(e){t+=e.realPrice*e.num,i+=(e.price-e.realPrice)*e.num}),(0,u["default"])(".js-total").html(t),(0,u["default"])(".js-discount").html(i)}},{key:"getCp",value:function(t){var i=[],e=this.combinationProducts[t],n=[1,2,3,4,5];return n.forEach(function(t){e["product"+t+"Id"]&&i.push({id:e["product"+t+"Id"],name:e["product"+t+"Name"],picPath:e["product"+t+"PicPath"],skus:e["product"+t+"Skus"],realPrice:e["product"+t+"RealPrice"],price:e["product"+t+"Price"],num:e["product"+t+"Num"]})}),(0,u["default"])('input[name="id"]').val(e.id),console.log(i),i}},{key:"renderTab",value:function(){var t=d["default"].compile(m["default"])({combinationProducts:this.combinationProducts});(0,u["default"])(".js-tab").html(t)}},{key:"renderItemList",value:function(){var t=d["default"].compile(p["default"])({cp:this.combinationProduct});(0,u["default"])("#itemList").html(t),this.setTotalPrice()}},{key:"initEvent",value:function(){var t=this;(0,u["default"])(document).on("click",".js-sku",function(i){t.showSku((0,u["default"])(i.currentTarget))}).on("click",".js-tab-item",function(i){t.changeTab((0,u["default"])(i.currentTarget))}).on("submit",".classicalmix-buybox",function(i){return!!t.validate()&&void t.submitForm((0,u["default"])(i.currentTarget))})}},{key:"submitForm",value:function(){var t=this.combinationProduct.map(function(t){return{productId:t.id,skuId:t.skuId||null,num:t.num}});(0,u["default"])('input[name="value"]').val(JSON.stringify(t))}},{key:"validate",value:function(){for(var t=!0,i=this.combinationProduct,e=0,n=i.length;e<n;e++)if(0!==i[e].skus.length&&!i[e].skuId){t=!1,o.Message.show({content:"请选择商品属性"});break}return t}},{key:"changeTab",value:function(t){if(!t.hasClass("active")){var i=+t.data("index");(0,u["default"])(".js-tab-item").removeClass("active"),t.addClass("active"),this.combinationProduct=this.getCp(i),this.renderItemList()}}},{key:"showSku",value:function(t){var i=this;this.tempIndex=t.data("index");var e=this.combinationProduct[this.tempIndex].id;(0,h.getItemDetail)(e).then(function(t){i.carBox||i.initShopCart(),i.carBox.show(3,t.data.product,t.data.productSkus)})}},{key:"initShopCart",value:function(){var t=this;this.carBox=new o.AddToCar,this.carBox.on("choose",function(i){var e,n=i.skuId;t.combinationProduct[t.tempIndex].skus.forEach(function(t){t.id===n&&(e=t.propertiesname)}),(0,u["default"])('.js-sku-value[data-index="'+t.tempIndex+'"]').html(e),t.combinationProduct[t.tempIndex].skuId=n,t.tempIndex=null})}}]),t}();new v},66:function(t,i){},83:function(t,i){t.exports='{{each cp as c index}} <div class="itemlist-item checkbox small"> <a class=itemlist-pic href="/product/getInfo?id={{c.id}}"> <img src={{c.picPath}}> </a> <div class=itemlist-detail> <a class=itemlist-title href="/product/getInfo?id={{c.id}}">{{c.name}}</a> {{if c.skus.length !== 0}} <div class=itemlist-sku> <span>颜色分类 :</span> <span class=js-sku-value data-index={{index}}></span> <span><a class="itemlist-skubtn js-sku" data-index={{index}}>选择商品属性</a></span> </div> {{/if}} </div> <div class=itemlist-vertical-price> <span>￥{{c.realPrice}}</span> <span>￥{{c.price}}</span> <span>x{{c.num}}</span> </div> </div> {{/each}}'},84:function(t,i){t.exports='{{each combinationProducts as cp index}} <li><a class="{{if index === 0}}active{{/if}} js-tab-item" data-index={{index}} href=javascript:void(0);>{{cp.cpName}}</a></li> {{/each}}'}});
//# sourceMappingURL=classicalmix.dc9441dd67fea734ecdd.js.map